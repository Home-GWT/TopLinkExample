
[ВИДЫ NOSQL И ИХ СРАВНЕНИЕ С РЕЛЯЦИОННЫМИ БАЗАМИ ДАННЫХ](http://www.lib.tpu.ru/fulltext/c/2014/C04/V2/015.pdf)

* [MongoDB](https://jsehelper.blogspot.com/2016/05/mongodb.html)


![База данных MongoDB](2.1.png)

* **(** в реляционных база данных состоит из `таблиц`; в NoSQL база данных состоит из `коллекций`; **)**
* **MongoDB** является `документо-ориентированной системой` в которой центральным понятием является `документ` — основанный на принципе хранении документов в формате *`BSON` [Binary JSON]* (в отличие от реляционных баз данных где используется табличное устройство с четко заданным количеством столбцов, типов данных, и со связями через внешние ключи)
* каждая `коллекция` имеет свое уникальное имя — произвольный идентификатор из 128 алфавитно-цифровых символов (не более чем) и знака подчеркивания
* для каждого `документа` в MongoDB определен уникальный идентификатор который называется — **_id** (При добавлении `документа` в `коллекцию` данный *идентификатор создается автоматически*. Однако разработчик *может сам явным образом задать идентификатор*)
* Пространство имен в MongoDB — это конкатенация имени базы данных и названия коллекции (например: *school.students*, где *school* — имя базы данных, а *students* — название коллекции)

* В NoSQL есть четыре типа хранилищ:
1. хранилища `ключ-значение` (это простейшее хранилище данных которое используюет `ключ` для доступа к `значению`. Например: *такие хранилища используются для хранения изображений — `GridFS`*)
2. хранилища `семейств колонок` (это двумерные массивы, к каждому ключу могут прикрепляться одна или несколько пар `ключ-значение`. *Они содержат `колонки` которые объединяются при помощи ключа в `записи`*. Такие системы позволяют хранить очень большие объёмы неструктурированных данных...)
3. `документно-ориентированные` (в которой *центральным понятием является `документ`* — это `JSON`-подобная схема данных)
4. `графовые` хранилища (основная модель хранения данных в которой является `математический граф` — *состоит из `вершин` и `связей`: где `вершины` представляют объекты данных, а `связи` представляют отношения между объектами*)


###Сравнение NoSQL с реляционными СУБД 

* Недостатки NoSQL перед реляционным СУБД:
  1. Отсутствует оператор `join`
  2. Отсутствие `транзакций` (атомарность гарантируется только на уровне целого `документа`...частичное обновление документа произойти не может. *Простой API затрудняет построение сложных SQL-запросов*...)
  3. Отсутствует `изоляции` (данные которые считываются одним клиентом могут параллельно изменяться другим клиентом)
  4. Отсутствует ограничения `внешнего ключа` (**foreign key** По умолчанию MongoDB не поддерживает отношения между `primary key - foreign key`. Но этого можна достичь путем встраивания одного документа внутри другого...)
  5. Требовательна к ресурсам - память и место на диске


* Преимущества NoSQL перед реляционными СУБД:
  1. Полная поддержка `индексов` — поддерживает создание *текстовых индексов для поддержки поиска текста внутри строки* (полнотекстовый поиск)
  2. Эффективное хранение двоичных данных больших объёмов (например: фото и видео)
  3. Поддержка отказоустойчивости и масштабируемости: набор `реплик` и `шардинг` (имеет распределенный доступ к данным, расположенных на нескольких серверах)
  4. `Журналирование операций` которые модифицируют данные в БД + `Профилирование запросов` (показывает рабочие характеристики каждой операции с базой данных)
  5. Операции обновления — это возможность обновления/вставки (*обновляет документ — если он найден; или создаёт новый документ — если он не найден;*. Пример: счётчик посещений для веб-сайта. - мы должны посмотреть, существует ли запись, и - в зависимости от результата - выполнить update либо insert...)
  6. (Отсутствие жестко заданной схемы данных. Широкий выбор типов хранилищ)


###Шардинг и Репликация

* **Шардинг** — это подход к масштабируемости, когда отдельные части данных хранятся на разных серверах (решает проблему горизонтального масштабирования)

* **Репликация** — это процесс синхронизации данных между несколькими серверами.

Позволяет добиться большей масштабируемости, и повысить доступность и сохранность данных.
А также позволяет восстанавливать даные после сбоя аппаратного обеспечения... 

* MongoDB поддерживает 2-формы репликации:
1. `реплисеты` (**Replica Sets**)
2. `ведущий-ведомый` (**Master-Slave**)

По умолчанию MongoDB:
1. записывает данные только в `primary` набор реплик.
2. а читает данные из `primary` и `secondary` наборов реплик.


###Селектор

* **Селектор** — *это JSON-объект. Он используется для поиска, подсчёта, обновления и удаления документов из коллекций* (в простейшем случае это может быть: `{}` — что означает выборку всех документов)

(Селектор запросов MongoDB аналогичен предложению `where` SQL-запроса)


###ObjectID

* **ObjectID** — это 12-байт типа BSON, имеющий следующую структуру:
1. Первые 4 байта, являются секундами
2. Следующие 3 байта являются идентификатором машины
3. Следующие 2 байта являются идентификатором процесса
4. Последние 3 байта это случайная величина


###MapReduce

* **Map/Reduce** — это подход к обработке больших объемов данных который состоит из 2-ух фаз: 
1. `Map` — предварительная обработка входных данных
2. `Reduce` — обработка тем или иным способом выборки, полученной на стадии Map.


    Это паралельная обработка данных одновременно на нескольких вычислительных серверах:
    - Общий объем данных делиться на порции и распределяется (отправляется) между серверами-обработчиками.
    - После того как каждый сервер обработает свою порцию данных, результаты этих данных собираются со всех серверов и объедидняются в общий результат...

Map/Reduce имеет два серьёзных преимущества по сравнению с традиционными решениями. 

* Преимущества `MapReduce`:
1. производительность (MapReduce может быть распараллелен на множестве ядер/процессоров/машин)
2. возможность описывать обработку данных нормальным кодом (по сравнению с тем что можно сделать с помощью SQL...)





